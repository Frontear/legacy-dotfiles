#!/bin/sh

case $1 in
    -m | --monitor)
        DEVICE_ID=$(wpctl inspect @DEFAULT_AUDIO_SINK@ | awk -F"\"" "/device.id/{print \$2}")
        pw-mon -oa | awk "/id: $DEVICE_ID/{print; fflush()}" | while read; do
            awk "{print \$2 * 100\":\"\$3}" <(wpctl get-volume @DEFAULT_AUDIO_SINK@)
        done
        ;;
    -M | --mute)
        wpctl set-mute @DEFAULT_AUDIO_SINK@ toggle
        ;;
    -i | --increase)
        wpctl set-volume @DEFAULT_AUDIO_SINK@ "${2:-5}%+" --limit 1.0
        ;;
    -d | --decrease)
        wpctl set-volume @DEFAULT_AUDIO_SINK@ "${2:-5}%-"
        ;;
esac
